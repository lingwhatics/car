---
title: "Mazda3 Analysis"
author: "Daley Mikalson"
date: "August 2, 2016"
output:
  html_document:
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      dpi=300)
library(dplyr)
library(magrittr)
library(ggplot2)
library(lubridate)
```

## The data
For some reason, I kept all the records related to my car for all the years that I owned it. Now that I have sold the car, I am going to clear all the paper out, but not before seeing what it tells me about what the car cost me.

I used a fuel tracker for iOS called [MileageKeeper](http://mileagekeeper.com "Mileage Keeper") and it worked well enough that I didn't ever look for a new one. It has the ability to export and import .csv files, which was quite helpful when Apple had to give me a new phone with a functioning camera.

I have all the service records at a couple different garages in Ottawa and Toronto. This includes oil changes, swapping winter/summer tires and repairs. The few times that I had to pay for parking are also in my saved data.

The only thing that is missing is all the random times that I stopped for car washes.

```{r data}
fuel <- read.csv("data/Mazda3.csv")

fuel$Distance <- c(-diff(fuel$Odometer),NA)
fuel$L.100km <- fuel$Fuel.Amount / fuel$Distance * 100
summary(fuel)

service <- read.csv("data/Service.csv")
summary(service)
fixed <- read.csv("data/Fixed.csv")
summary(fixed)
parking <- read.csv("data/Parking.csv")
summary(parking)

```

Let's look at the total for each cost area.

```{r summarise}
totals <- summarise(group_by(fixed, Type), Cost = sum(Cost))
totals <- rbind(totals, summarise(group_by(service, Type), Cost = sum(Cost)))
totals <- rbind(totals, data.frame(Type = "Fuel", Cost = sum(fuel$Total.Cost)))
totals <- rbind(totals, data.frame(Type = "Parking", Cost = sum(parking$Cost)))
totals
sum(totals$Cost)
```

```{r bars, echo = FALSE}
p <- ggplot(totals, aes(x = reorder(Type, -Cost), y = Cost))
p + geom_bar(stat = "identity", position = "identity") +
  xlab("Type of Cost") + theme(axis.text.x = element_text(angle=90))
```


```{r annual}

summarise(group_by(fuel, year(Date)), Cost = sum(Total.Cost))

summarise(group_by(parking, year(Start.Date)), Cost = sum(Cost))
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
q <- ggplot(fuel, aes(x=Odometer, y=Fuel.Amount))
q + geom_bar(stat="identity")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
